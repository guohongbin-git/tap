### **修订记录 (Change Log)**

| 版本 (Version) | 日期 (Date) | 变更内容 (Change Description) | 作者 (Author) | 审批人 (Approved By) |
| :--- | :--- | :--- | :--- | :--- |
| 1.1 | 2025年8月15日 | v1.0版本已由郭宏斌评审通过。更新审批状态。 | Gemini | (待审批) |
| 1.0 | 2025年8月15日 | 初版创建，定义了UI/UX的设计原则、技术选型和核心视图。 | Gemini | 郭宏斌 |

---
**版本**: 1.1
**状态**: 已批准 (Approved)

---

# **UI/UX 设计文档 (DDR_03)**

## 1. 概述 (Overview)

本文档旨在为“TAP工具箱”项目定义高层级的用户界面（UI）和用户体验（UX）设计。其目标是创建一个功能强大、数据密集，但同时直观、易于使用的Web应用程序，服务于我们的所有目标用户。

## 2. 设计原则

*   **数据为先 (Data-First)**: 所有界面设计都应围绕如何最清晰、最有效地展示核心数据（地图、图表、指标）来展开。
*   **清晰至上 (Clarity over Clutter)**: 避免不必要的装饰和复杂的布局，确保用户能快速找到关键信息和操作。
*   **交互驱动 (Interaction-Driven)**: 核心视图应具备高度的交互性，允许用户通过操作（如缩放、悬停、点选、拖拽）来探索数据和方案，而不仅仅是静态地查看。

## 3. 技术选型

*   **Web框架**: 推荐使用 **Dash (by Plotly)**。
    *   **理由**: Dash是一个纯Python的Web应用框架，专门用于构建数据分析类应用。它与`pandas`和`geopandas`无缝集成，并且其底层的Plotly库非常适合生成我们所需要的高度交互、高质量的图表。相比Streamlit，Dash在构建复杂、多页面、自定义布局的应用时提供了更高的灵活性。
*   **可视化引擎**: **Plotly**。
    *   **理由**: Plotly是生成**SVG（可缩放矢量图形）**和WebGL图形的核心库。使用它，我们可以确保所有的地图和图表都具备以下优点：
        1.  **无损缩放**: 在任何分辨率下都保持清晰，不会出现像素化。
        2.  **丰富的交互性**: 支持悬停提示（hover tooltips）、点选、框选、缩放等丰富的交互操作。
        3.  **易于集成**: 作为Dash的核心组件，集成过程非常顺畅。

## 4. 核心界面视图 (Core Views)

应用程序将由以下几个核心视图（页面）组成：

**4.1. 视图一：实验主页 (Dashboard)**
*   **目的**: 项目的入口，展示所有历史实验的列表。
*   **核心组件**:
    *   一个可搜索、可排序的表格，列出每次实验的ID、名称、运行时间、使用的算法、以及关键的顶层评估结果。
    *   点击列表中的某一项，可以跳转到该实验的“结果对比页”。

**4.2. 视图二：实验配置页 (Configuration)**
*   **目的**: 引导用户通过表单，以可视化的方式创建新的实验。
*   **核心组件**:
    *   数据选择模块：允许用户选择一个已有的数据集，或配置“数据生成器”的参数来生成新数据。
    *   算法选择模块：允许用户选择一个或多个算法进行对比，并为每个算法设置其特定的参数。
    *   评估指标选择模块：允许用户选择此次实验关注哪些评估指标。
    *   一个“开始实验”按钮，点击后将生成对应的YAML配置文件，并交由后端的“自动化调度中心”执行。

**4.3. 视图三：结果对比页 (Comparison View)**
*   **目的**: 并排、同步地对比两个或多个实验方案的结果，这是本工具箱的核心价值之一。
*   **核心组件**:
    *   **地图面板**: 多个并排的、交互式的地图，每个地图显示一个方案的划分结果。地图之间应实现**视图同步**（例如，缩放或平移一个地图，其他地图会跟随移动）。
    *   **指标面板**: 以图表（如雷达图、条形图）和表格的形式，清晰地对比各个方案在所有评估指标上的得分。
    *   **日志面板**: 显示本次实验生成的、图文并茂的LLM日志。

**4.4. 视图四：手动编辑与仿真页 (Interactive Editor)**
*   **目的**: 实现“人机协同”，允许用户在算法生成的基础上进行手动微调。
*   **核心组件**:
    *   一个大的、交互式的地图，显示单个划分方案。
    *   支持通过**点选或拖拽**，将某个基础地理单元（如一个邮区）从一个区域重新分配给另一个相邻区域。
    *   一个实时更新的指标仪表盘，在用户每次调整后，**立即重新计算并显示**两个受影响区域的各项指标（如工作量、潜力）的变化，为决策提供即时反馈。

**4.5. 视图五：LLM问答页 (LLM Assistant)**
*   **目的**: 提供与内置LLM进行对话的界面。
*   **核心组件**:
    *   一个标准的聊天机器人界面。
    *   用户可以在选择一个具体的实验结果后，在此页面进行提问。系统会自动将该实验的MCP上下文（图文日志）注入到LLM的背景知识中，以获得针对性强、内容丰富的回答。